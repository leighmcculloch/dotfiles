# Homebrew settings
export HOMEBREW_NO_ANALYTICS=1
export HOMEBREW_VERBOSE=1
export HOMEBREW_VERIFY_ATTESTATIONS=1
export HOMEBREW_NO_INSECURE_REDIRECT=1
export HOMEBREW_DISPLAY_INSTALL_TIMES=1
export HOMEBREW_BOOTSNAP=1
export HOMEBREW_ALLOWED_TAPS=
export HOMEBREW_CASK_OPTS=--require-sha

# Hardcoded brew prefix for each platform (avoids slow $(brew --prefix) calls)
os="$(uname -s -m)"
case $os in
  "Darwin x86_64"*) BREW_PREFIX=/usr/local ;;
  "Darwin arm64"*) BREW_PREFIX=/opt/homebrew ;;
  "Linux"*) BREW_PREFIX=/home/linuxbrew/.linuxbrew ;;
  *) BREW_PREFIX= ;;
esac

export BREW_PREFIX

if [ -n "$BREW_PREFIX" ] && [ -d "$BREW_PREFIX" ]; then
  export PATH="$BREW_PREFIX/bin:$PATH"
  fpath=($fpath "$BREW_PREFIX/share/zsh/site-functions/")

  # sccache for rust
  export RUSTC_WRAPPER="$BREW_PREFIX/bin/sccache"
  export SCCACHE_CACHE_SIZE="50G"

  # rustup bin install path
  export PATH="$BREW_PREFIX/opt/rustup/bin:$PATH"

  # python unversioned bin path
  export PATH="$BREW_PREFIX/opt/python/libexec/bin:$PATH"

  # npm root path
  export NPM_ROOT="$BREW_PREFIX/lib/node_modules"
fi
